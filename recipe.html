<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Main</title>
    <!-- <link rel="stylesheet" type="text/css" href="style.css" /> -->
    <style>
    .header{
        background-color: #f74a4a;
        text-align: center;
        padding: 30px;
        top: 0;
        left:0;
        width: 100%;
        z-index: 2;
        text-shadow: -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px -1px 0 #FFFFFF;
    }

    .topnav{
        overflow: hidden;
        background-color: #333;
        top: 60px;
        left:0;
        width: 100%;
        z-index:2;
        text-align: center;
        color: white;
        padding: 6px;
        font-weight: lighter;
    }

    .bottombar{
        overflow: hidden;
        background-color: lightblue;
        height: 100px;
        left:0;
        width: 100%;
        bottom: 0%;
        position: fixed;
        z-index:2;
    }

    .button {
        text-align:center;
        background-color:black;
        background-image: linear-gradient(white, #FF853B);
        background-size: 30px 100%, 100% 100%;
        width:20vw;
        height:50px;
        top:20px;
        line-height:20px;
        padding: 0px;
        color:black;
        margin: 5px 8px;
        border: 3px black solid;
        border-radius: 10px;
        font-size: 17px;
        text-decoration: none;
        position:relative;
        float:left;
        z-index:3;
    }

    .farleft {
        left:3vw;
    }
    .midleft {
        left:6vw;
    }
    .midright {
        left:9vw;
    }
    .farright {
        left:12vw;
    }

    .button:hover {
        background-image: linear-gradient(white, #FF9F5C);
        cursor: pointer;
    }

    .button:active {
        background-image: linear-gradient(white, #FFC093);
        cursor: pointer;
    }

    .container {
        position: relative;
        text-align: center;
        z-index: -1;
        width: 100%;
    }

    .subtitle {
      /*  position: absolute;
        top: 30%;
        left: 25%;
        transform: translate(-50%, -50%); */
        color: #000;
        text-decoration: none;
        font-size: 30px;
        font-family: sans-serif;
    }

    .recipe_block {
        margin: 25px;
        border: 3px solid #000;
        float: left;
        width: 300px;
        height: 390px;
        background-color: #c3ebe7;

    }

    .recipe_block img {
        width: 300px;
        height: 300px;
    }
    .desc {
        padding: 15px;
        text-align: center;
    }

    .results {
        display: none;
    }

    .error{
		color: #D20E11;
		border: solid 1px #d20e11;
		display: none;
		padding: 1px 15px;
	 }
    </style>

    <script>
    urls = new Array();
    images = new Array();
    names = new Array();

    function recipe()
    {
      var query = document.getElementsByName("query")[0].value;

      //if(query == ""){
      //   document.getElementById("noinput").style.display = "inline-block";
       //}
      //  else{
      //    document.getElementById("noinput").style.display = "none";
          request = new XMLHttpRequest();
          console.log("1 - request object created");

          // url = "https://api.edamam.com/search?q=chicken&app_id=ea82839e&app_key=6e8bc70b6a0631d3b4b16b5c4a135d65";
          url = "https://api.edamam.com/search?q=" + query + "&app_id=ea82839e&app_key=6e8bc70b6a0631d3b4b16b5c4a135d65&from=0&to=30";
          request.open("GET", url, true)
          console.log("2 - opened request file");
          //runs when the state changes
          alert("hi");
          request.onreadystatechange = function()
          {
            alert("hey");
              //if the operation is complete and the status is complete
              if (request.readyState == 4 && request.status == 200)
              {
                  console.log("5 - response received");
                  //gets the data
                  result = request.responseText;

                  //putting the data back into the object
                  food = JSON.parse(result);

                  numRecipes = food.to;
                  for (i=0; i<numRecipes; i++)
                  {
                      document.getElementById("name" + i + "div").innerHTML += food.hits[i].recipe.label;
                      document.getElementById("name" + i + "div").setAttribute("href", food.hits[i].recipe.url);
                      document.getElementById("image" + i + "div").setAttribute("src", food.hits[i].recipe.image);
                      document.getElementById("name" + i).setAttribute("value", food.hits[i].recipe.label);
                      document.getElementById("url" + i).setAttribute("value", food.hits[i].recipe.url);
                      document.getElementById("image" + i).setAttribute("value", food.hits[i].recipe.image);
                      urls[i] = food.hits[i].recipe.url;
                      images[i] = food.hits[i].recipe.image;
                      names[i] = food.hits[i].recipe.label;
                      alert(food.hits[i].recipe.label);
                  }
              }
              //request status is not yet ready
              else if (request.readyState == 4 && request.status != 200) {

                  document.getElementById("data").innerHTML = "Something " +
                  "is wrong!  Check the logs to see where this went off "
                  + "the rails";
              }
              //request state is not yet ready
              else if (request.readyState == 3) {
                  document.getElementById("data").innerHTML = " ";
              }
            }

        // sending the request for the data from the web server
        request.send();
        console.log("4 - Request sent");
        document.getElementById("results").style.display = "inline";
      }
    //}
    </script>
</head>

<body>
    <h1 class="header">Your Recipe Book </h1>
    <h3 class="topnav">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspInput an ingredient to find a new recipe!</h3>

    <div>
      <img src="https://gillianroeca.smugmug.com/My-First-Gallery/n-Dwq8hz/i-nC2JZ7z/A" style=" width:192px; height:120px;" />
  </div>

    <form id="search" onsubmit="return recipe()">
        <p class="subtitle">
          Input Ingredient: <input type="text" name="query"></input>
          <div id="noinput" class="error">Ingredient is required </div></p>
          <input name="button" type="submit" value="Submit">
    </form>

    <h3 class="topnav" style="padding: 2px; color: #333;" > space </h3>

    <script language="javascript">
    var t = "";
    t += "<div id='data'></div><br>";
    t += "<div class='results' id='results'>";
      for (i=0; i<30; i++)s
      {
          t += "<div class='recipe_block' id='recipe'"+i+"' >";
          t += "<a href='' id='name"+i+"div'></a>";
          t += "<div class='desc'>";
          //t += "<form method='post' action='http://localhost:8080/add' >";
           t += "<form method='post' action='https://codebloodedfinal.herokuapp.com/add' >";
          t += "<input type='submit' name='box"+i+"' value='Add To: '>";
          t += "<input type='radio' name='choose"+i+"' value='Favorites'/> Favorites";
          t += "<input type='radio' name='choose"+i+"' value='Did Not Like' /> Did Not Like";
          t += "<input type='radio' name='choose"+i+"' value='Want To Try'/> Want To Try";
          t += "<input type='text' id='name"+i+"' name='name"+i+"' value='' style='display:none'/>";
          t += "<input type='text' id='url"+i+"' name='url"+i+"' value='' style='display:none'/>";
          t += "<input type='text' id='image"+i+"' name='image"+i+"' value='' style='display:none'/>";
          t += "</form>";
          t += "</div>";
          t += "<img id='image"+i+"div' src='' width='10' height='10'>";
          t += "</div>";
      }
    t += "</div></div>";
    document.write(t);
    </script>

    <div id="format"></div>

    <h4 class="bottombar" >
      <h4 class="bottombar" >
         <form method="post" action="https://codebloodedfinal.herokuapp.com/display">
          <!-- <form method="post" action="http://localhost:8080/display">-->
          <input type="submit" class="button farleft" name="submit" value="Favorites">
          <input type="submit" class="button midleft" name="submit" value="Want to Try">
          <input type="submit" class="button midright" name="submit" value="Didn't Like">
          <input type="submit" class="button farright" name="submit" value="Explore">
      </form>
    </h4>

</body>
</html>
