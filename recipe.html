<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Main</title>
        <link rel="stylesheet" type="text/css" href="style.css" />
        <style>
        .header{
            background-color: #f74a4a;
            text-align: center;
            padding: 30px;
        		position: fixed;
        		top: 0;
        		left:0;
        		width: 100%;
        	z-index: 2;
        	text-shadow: -1px 1px 0 #FFFFFF, 1px 1px 0 #FFFFFF, 1px -1px 0 #FFFFFF, -1px -1px 0 #FFFFFF;
        }

        .topnav{
            overflow: hidden;
            background-color: #333;
        		position: fixed;
        		top: 115px;
        		left:0;
        		width: 100%;
        		z-index:5;
        		}
        .container {
            position: relative;
            text-align: center;
            z-index: -1;
          	width: 100%;
          }

        .subtitle {
          	position: absolute;
          	top: 30%;
          	left: 25%;
          	transform: translate(-50%, -50%);
          	color: #fff;
          	text-decoration: none;
          	font-size: 30px;
          	font-family: sans-serif;
          }

        </style>

        <script>
            function recipe()
            {
                document.getElementsByName("query")[0].style.display = "none";
                document.getElementsByName("button")[0].style.display = "none";
                request = new XMLHttpRequest();
                console.log("1 - request object created");
                //q is the query parameter
                //this is what we want the user to input


                //var query = "<?php echo $_POST['input']; ?>";
                var query = document.getElementsByName("query")[0].value;
                alert(query);
                document.getElementById("keyword").innerHTML += query;

                // query = document.getElementById("input").value;

                // url = "https://api.edamam.com/search?q=chicken&app_id=ea82839e&app_key=6e8bc70b6a0631d3b4b16b5c4a135d65";
                url = "https://api.edamam.com/search?q=" + query + "&app_id=ea82839e&app_key=6e8bc70b6a0631d3b4b16b5c4a135d65";
                request.open("GET", url, true)
                console.log("2 - opened request file");
            //runs when the state changes
            request.onreadystatechange = function()
            {
                //if the operation is complete and the status is complete
                if (request.readyState == 4 && request.status == 200)
                {
                    console.log("5 - response received");
                    //gets the data
                    result = request.responseText;
                    //writing the raw data
                    // document.getElementById("data").innerHTML = result
                    // + "<br/><br/>";

                    //putting the data back into the object
                    food = JSON.parse(result);

                    // document.getElementById("query").innerHTML +=
                    // food.q;

                    numRecipes = food.to;
                    for (i=0; i<numRecipes; i++)
                    {
                        document.getElementById("format").innerHTML +=
                        food.hits[i].recipe.label + ", ";
                    }


                }
                //request status is not yet ready
                else if (request.readyState == 4 && request.status != 200) {

                    document.getElementById("data").innerHTML = "Something " +
                        "is wrong!  Check the logs to see where this went off "
                        + "the rails";

                }
                //request state is not yet ready
                else if (request.readyState == 3) {

                    document.getElementById("data").innerHTML = "Too soon! " +
                        "Try again";

                }
            }
            // sending the request for the data from the web server
            request.send();
            console.log("4 - Request sent");
        }


        </script>
    </head>
    <body>




  <h1 class="header"> Your Recipe Book </h1>

  <h3 class="topnav" >nav</h3>

  <div class="spacing" style="height:180px">
      <p></p>
  </div>

  <div class="container">
        <img src="background.jpeg" style="width:100%">
  </div>

  <p class="subtitle">

    Input Ingredient: <input type="text" name="query"></input>
  <br><br>

  <button type="submit" name="button" onClick="recipe()">Submit</button>

  </p>

        <!-- <form method="post" onsubmit="recipe()">

            <div id="text">

                Input ingredient: <input type="text" id="input" name="input">

            </div>

            <br><br>
            <input type="submit" value="Submit">

        </form> -->

        <div id="data"></div><br><br><br><br>
        <!-- label = name of recipe, source = where recipe is from, url = link to recipe  -->



        <div id="keyword">Keyword used: </div><br><br>
        <div id="format"></div>


    </body>
</html>
